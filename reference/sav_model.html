<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Apply Random Forest models — sav_model • SAVM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Apply Random Forest models — sav_model"><meta name="description" content="Apply Random Forest models to predict SAV cover and presence/absence, with
optional post-hoc processing."><meta property="og:description" content="Apply Random Forest models to predict SAV cover and presence/absence, with
optional post-hoc processing."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SAVM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.9004</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/get_started.html">Get started with SAVM</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/FishEcologyScience/SAVM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Apply Random Forest models</h1>
      <small class="dont-index">Source: <a href="https://github.com/FishEcologyScience/SAVM/blob/main/R/model.R" class="external-link"><code>R/model.R</code></a></small>
      <div class="d-none name"><code>sav_model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Apply Random Forest models to predict SAV cover and presence/absence, with
optional post-hoc processing.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sav_model</span><span class="op">(</span></span>
<span>  <span class="va">dat</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cover"</span>, <span class="st">"pa"</span><span class="op">)</span>,</span>
<span>  depth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fetch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  substrate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  secchi <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  limitation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vmax_par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">1.4</span>, slope <span class="op">=</span> <span class="fl">1.33</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p><code>data.frame</code>|<code>sf</code><br> A <code>data.frame</code> or a <code>sf</code> object containing some or all of the
following columns:</p><ul><li><p><code>depth_m</code>: Numeric, depth in meters.</p></li>
<li><p><code>fetch_km</code>: Numeric, fetch in kilometers.</p></li>
<li><p><code>secchi</code>: Numeric Secchi depth in meters (post_hoc)</p></li>
<li><p><code>substrate</code>: Binary (0 = absent, 1 = present), indicating substrate
limitations. (post_hoc)</p></li>
<li><p><code>limitation</code>: Binary (0 = absent, 1 = present), indicating user-supplied
limitations.
Additional columns will be ignored.</p></li>
</ul></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p><code>character vector</code>, either <code>"cover"</code> or <code>"pa"</code><br>
Model type(s).</p></dd>


<dt id="arg-depth-fetch">depth, fetch<a class="anchor" aria-label="anchor" href="#arg-depth-fetch"></a></dt>
<dd><p><code>character</code><br> Column specification for the predictors,
see <em>Details</em>.</p></dd>


<dt id="arg-substrate-secchi-limitation">substrate, secchi, limitation<a class="anchor" aria-label="anchor" href="#arg-substrate-secchi-limitation"></a></dt>
<dd><p><code>character</code><br>Column specification for post_hoc
variables, see <em>Details</em>.</p></dd>


<dt id="arg-vmax-par">vmax_par<a class="anchor" aria-label="anchor" href="#arg-vmax-par"></a></dt>
<dd><p><code>named list</code><br> intercept and slope of the equation from
Chambers and Kalff (1985) to compute the maximum depth of plant colonization
(Vmax), see <em>Details</em> below.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame (or a sf object) containing the input columns along with model
predictions.</p>
<p>The prediction column names match the values specified in <code>type</code> followed
by the suffix <code>_pred</code>, and contain the raw model outputs (i.e., without
post-hoc adjustment).</p>
<p>Post-hoc adjusted predictions (see <em>Details</em>) are included in additional
columns with the same names as the <code>type</code> values, but with the suffix
<code>_post_hoc</code>.</p>
<p>If a column <code>secchi</code> is present, then two additional columns are
returned: <code>vmax</code> and <code>limitation_secchi</code>, see details for further
explanation.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>There are two sets of models available. The first set consists of models
predicting the presence or absence of SAV, while the second set focuses on
SAV cover. Each set includes three random forest models: one using depth as
a predictor, another using fetch, and a third combining both variables. For
further details, see Croft-White (2022).</p>
<p>The selected model for generating predictions is determined by the type
argument, which specifies the output as either cover or presence-absence,
depending on the available predictors. The required input variables—depth,
fetch, substrate, secchi, limitation—must correspond to column names in
<code>dat</code>; otherwise, an error is thrown. If neither 'depth' nor 'fetch' is
explicitly provided, the function will attempt to infer them from the column
names. Matching is case-insensitive and will detect 'depth_m', 'depth',
'fetch_km' and 'fetch'.</p>
<p>If <code>secchi</code> is provided, two additional columns are returned:</p><ul><li><p><code>vmax</code>: Predicted maximum colonization depth calculated using the Chambers
and Kalff equation.</p></li>
<li><p><code>limitation_secchi</code>: Logical column indicating light limitation. <code>TRUE</code> if
<code>vmax &gt;= depth_m</code>,  indicating the site is light-limited; <code>FALSE</code> otherwise.</p></li>
</ul><p>The regression parameters for the Chambers and Kalff equation can be
adjusted via the <code>vmax_par</code> argument. By default, parameters from Model A
(Quebec and international lakes) in Croft-White et al. (2022) are used. To
apply Model B (Quebec lakes only), use:</p>
<p><code>vmax_par = list(intercept = 1.32, slope = 1.14)</code></p>
<p>The post-hoc treatment adjusts raw predictions by setting them to 0 wherever
limitations are present. Possible limitation columns include <code>substrate</code>,
<code>limitation</code>, and <code>limitation_secchi</code> (see descriptions above). These
columns are treated as binary indicators: any value greater than 0 is
interpreted as a limiting condition. If a limitation is detected, the
corresponding prediction is set to 0 in the post-hoc adjusted output.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Croft-White, M.V., Tang, R., Gardner Costa, J., Doka, S.E., and Midwood, J.
D. 2022. Modelling submerged aquatic vegetation presence and percent cover
to support the development of a freshwater fish habitat management tool.
Can. Tech. Rep. Fish. Aquat. Sci. 3497: vi + 30 p.</p></li>
<li><p>Chambers, P.A., and Kalff, J. 1985. Depth Distribution and Biomass of
Submerged aquatic macrophyte communities in relation to secchi depth.
Can. J. Fish. Aquat. Sci. 42: 701–709</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># basic usage </span></span></span>
<span class="r-in"><span><span class="fu">sav_model</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>depth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Looking for depth and fetch in column names.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Found Depth in column names.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Using cover and pa with depth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   depth_m pa_pred cover_pred pa_post_hoc cover_post_hoc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       5       1   85.43167           1       85.43167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      10       0   21.14400           0        0.00000</span>
<span class="r-in"><span><span class="fu">sav_model</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>depth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>, fetch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"pa"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Looking for depth and fetch in column names.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Found Fetch and Depth in column names.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Using pa with depth+fetch</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   depth_m fetch_km pa_pred pa_post_hoc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       5        1       0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      10        2       0           0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using post-hoc treatment </span></span></span>
<span class="r-in"><span><span class="fu">sav_model</span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  depth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  fetch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">10</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  secchi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  substrate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Looking for depth and fetch in column names.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Found Fetch and Depth in column names.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Using cover and pa with depth+fetch</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   depth_m fetch_km secchi limitation_secchi     vmax substrate pa_pred</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       5        1      1             FALSE  1.76890      TRUE       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      10        2     10              TRUE 19.29351      TRUE       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       5       10     10              TRUE 19.29351     FALSE       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cover_pred pa_post_hoc cover_post_hoc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   77.11233           0              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   44.66533           0              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   60.24833           0              0</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kevin Cazelles, David Beauchesne, Paul Bozneck.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

